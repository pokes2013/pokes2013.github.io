# 制造业订单管理系统数据库设计完整模板
本模板基于**离散制造业生产订单全流程管理**设计，覆盖**客户订单、生产计划、物料需求、车间执行、成品入库、发货结算**六大核心环节，遵循关系型数据库三大范式，兼顾数据一致性与业务实用性，可直接适配 MySQL、SQL Server 等主流数据库。

## 一、设计说明
1. **核心业务流程**：客户下单 → 销售审核 → 生成生产订单 → 物料需求计算 → 车间排产 → 生产执行 → 成品入库 → 发货 → 对账结算
2. **设计原则**
    - 区分**销售订单**与**生产订单**：应对“一张销售单对应多张生产单”“一张生产单对应多个销售单”的复杂场景；
    - 关联**物料、设备、人员**维度：支撑生产过程追溯；
    - 预留**状态字段**：适配订单全生命周期状态流转。

## 二、核心数据表结构
### 1. 基础信息表
#### 1.1 客户信息表（`customer`）
| 字段名 | 数据类型 | 约束 | 注释 |
| ---- | ---- | ---- | ---- |
| `customer_id` | BIGINT UNSIGNED | PRIMARY KEY, AUTO_INCREMENT | 客户唯一ID |
| `customer_code` | VARCHAR(30) | NOT NULL, UNIQUE | 客户编码（如 C001） |
| `customer_name` | VARCHAR(100) | NOT NULL | 客户全称 |
| `contact_person` | VARCHAR(50) |  | 对接人姓名 |
| `contact_phone` | VARCHAR(20) | NOT NULL | 对接人电话 |
| `address` | VARCHAR(200) |  | 客户地址 |
| `credit_limit` | DECIMAL(15,2) | DEFAULT 0 | 客户信用额度 |
| `status` | TINYINT | DEFAULT 1 | 状态：1-有效 0-失效 |
| `create_time` | DATETIME | DEFAULT CURRENT_TIMESTAMP | 创建时间 |

#### 1.2 产品信息表（`product`）
| 字段名 | 数据类型 | 约束 | 注释 |
| ---- | ---- | ---- | ---- |
| `product_id` | BIGINT UNSIGNED | PRIMARY KEY, AUTO_INCREMENT | 产品唯一ID |
| `product_code` | VARCHAR(30) | NOT NULL, UNIQUE | 产品编码（如 M001，电机型号） |
| `product_name` | VARCHAR(100) | NOT NULL | 产品名称（如 三相异步电机） |
| `spec` | VARCHAR(100) |  | 产品规格（如 功率、电压、转速） |
| `unit` | VARCHAR(10) | NOT NULL | 计量单位（如 台、套） |
| `cost_price` | DECIMAL(10,2) | NOT NULL | 产品成本价 |
| `sale_price` | DECIMAL(10,2) | NOT NULL | 产品销售指导价 |
| `status` | TINYINT | DEFAULT 1 | 状态：1-在售 0-下架 |

#### 1.3 物料信息表（`material`）
| 字段名 | 数据类型 | 约束 | 注释 |
| ---- | ---- | ---- | ---- |
| `material_id` | BIGINT UNSIGNED | PRIMARY KEY, AUTO_INCREMENT | 物料唯一ID |
| `material_code` | VARCHAR(30) | NOT NULL, UNIQUE | 物料编码（如 铜线圈-T001） |
| `material_name` | VARCHAR(100) | NOT NULL | 物料名称 |
| `spec` | VARCHAR(100) |  | 物料规格（如 线径、材质） |
| `unit` | VARCHAR(10) | NOT NULL | 计量单位（如 kg、个） |
| `stock_qty` | DECIMAL(10,2) | DEFAULT 0 | 当前库存数量 |
| `min_stock` | DECIMAL(10,2) | DEFAULT 0 | 安全库存下限 |

### 2. 订单核心表
#### 2.1 销售订单表（`sales_order`）—— 客户下单记录
| 字段名 | 数据类型 | 约束 | 注释 |
| ---- | ---- | ---- | ---- |
| `so_id` | BIGINT UNSIGNED | PRIMARY KEY, AUTO_INCREMENT | 销售订单ID |
| `so_code` | VARCHAR(30) | NOT NULL, UNIQUE | 销售订单编号（如 SO20250101001） |
| `customer_id` | BIGINT UNSIGNED | NOT NULL, FOREIGN KEY → customer.customer_id | 客户ID |
| `order_date` | DATE | NOT NULL | 下单日期 |
| `delivery_date` | DATE | NOT NULL | 客户要求交货日期 |
| `total_amount` | DECIMAL(15,2) | NOT NULL | 订单总金额 |
| `status` | TINYINT | DEFAULT 0 | 订单状态：0-待审核 1-已审核 2-生产中 3-已发货 4-已完成 5-已取消 |
| `remark` | VARCHAR(500) |  | 订单备注（如 特殊包装要求） |
| `creator` | VARCHAR(50) | NOT NULL | 制单人 |
| `create_time` | DATETIME | DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| **索引** |  |  | `idx_customer_id`（客户ID）、`idx_so_code`（订单编号） |

#### 2.2 销售订单明细表（`sales_order_item`）—— 订单产品明细
| 字段名 | 数据类型 | 约束 | 注释 |
| ---- | ---- | ---- | ---- |
| `so_item_id` | BIGINT UNSIGNED | PRIMARY KEY, AUTO_INCREMENT | 明细ID |
| `so_id` | BIGINT UNSIGNED | NOT NULL, FOREIGN KEY → sales_order.so_id | 关联销售订单ID |
| `product_id` | BIGINT UNSIGNED | NOT NULL, FOREIGN KEY → product.product_id | 产品ID |
| `qty` | DECIMAL(10,2) | NOT NULL | 订购数量 |
| `unit_price` | DECIMAL(10,2) | NOT NULL | 实际成交单价 |
| `amount` | DECIMAL(15,2) | NOT NULL | 明细金额（qty × unit_price） |
| **索引** |  |  | `idx_so_id`（销售订单ID） |

#### 2.3 生产订单表（`production_order`）—— 车间生产任务
| 字段名 | 数据类型 | 约束 | 注释 |
| ---- | ---- | ---- | ---- |
| `po_id` | BIGINT UNSIGNED | PRIMARY KEY, AUTO_INCREMENT | 生产订单ID |
| `po_code` | VARCHAR(30) | NOT NULL, UNIQUE | 生产订单编号（如 PO20250101001） |
| `so_id` | BIGINT UNSIGNED | FOREIGN KEY → sales_order.so_id | 关联销售订单ID（可为空，适配备货生产） |
| `product_id` | BIGINT UNSIGNED | NOT NULL, FOREIGN KEY → product.product_id | 生产产品ID |
| `plan_qty` | DECIMAL(10,2) | NOT NULL | 计划生产数量 |
| `start_date` | DATE | NOT NULL | 计划开始日期 |
| `end_date` | DATE | NOT NULL | 计划完成日期 |
| `actual_qty` | DECIMAL(10,2) | DEFAULT 0 | 实际完成数量 |
| `status` | TINYINT | DEFAULT 0 | 状态：0-待排产 1-生产中 2-已完成 3-已入库 4-已取消 |
| `workshop` | VARCHAR(50) | NOT NULL | 负责车间（如 电机装配车间） |
| `foreman` | VARCHAR(50) |  | 车间负责人 |
| **索引** |  |  | `idx_so_id`（销售订单ID）、`idx_product_id`（产品ID） |

### 3. 生产执行关联表
#### 3.1 物料需求表（`material_requirement`）—— MRP计算结果
| 字段名 | 数据类型 | 约束 | 注释 |
| ---- | ---- | ---- | ---- |
| `mr_id` | BIGINT UNSIGNED | PRIMARY KEY, AUTO_INCREMENT | 需求ID |
| `po_id` | BIGINT UNSIGNED | NOT NULL, FOREIGN KEY → production_order.po_id | 关联生产订单ID |
| `material_id` | BIGINT UNSIGNED | NOT NULL, FOREIGN KEY → material.material_id | 物料ID |
| `require_qty` | DECIMAL(10,2) | NOT NULL | 需求数量 |
| `stock_qty` | DECIMAL(10,2) | NOT NULL | 可用库存数量 |
| `purchase_qty` | DECIMAL(10,2) | DEFAULT 0 | 需采购数量 |
| `status` | TINYINT | DEFAULT 0 | 状态：0-待领料 1-已领料 2-已核销 |

#### 3.2 生产工序表（`production_process`）—— 车间工序记录
| 字段名 | 数据类型 | 约束 | 注释 |
| ---- | ---- | ---- | ---- |
| `process_id` | BIGINT UNSIGNED | PRIMARY KEY, AUTO_INCREMENT | 工序ID |
| `po_id` | BIGINT UNSIGNED | NOT NULL, FOREIGN KEY → production_order.po_id | 关联生产订单ID |
| `process_name` | VARCHAR(50) | NOT NULL | 工序名称（如 定子绕线、转子装配） |
| `process_seq` | TINYINT | NOT NULL | 工序顺序（如 1-第一道工序） |
| `start_time` | DATETIME |  | 工序开始时间 |
| `end_time` | DATETIME |  | 工序完成时间 |
| `operator` | VARCHAR(50) |  | 操作员 |
| `status` | TINYINT | DEFAULT 0 | 状态：0-未开始 1-进行中 2-已完成 |

### 4. 入库与发货表
#### 4.1 成品入库单（`finished_product_stock`）
| 字段名 | 数据类型 | 约束 | 注释 |
| ---- | ---- | ---- | ---- |
| `stock_id` | BIGINT UNSIGNED | PRIMARY KEY, AUTO_INCREMENT | 入库单ID |
| `stock_code` | VARCHAR(30) | NOT NULL, UNIQUE | 入库单编号（如 IN20250101001） |
| `po_id` | BIGINT UNSIGNED | NOT NULL, FOREIGN KEY → production_order.po_id | 关联生产订单ID |
| `product_id` | BIGINT UNSIGNED | NOT NULL, FOREIGN KEY → product.product_id | 产品ID |
| `in_qty` | DECIMAL(10,2) | NOT NULL | 入库数量 |
| `in_time` | DATETIME | DEFAULT CURRENT_TIMESTAMP | 入库时间 |
| `keeper` | VARCHAR(50) | NOT NULL | 库管员 |

#### 4.2 发货单（`delivery_order`）
| 字段名 | 数据类型 | 约束 | 注释 |
| ---- | ---- | ---- | ---- |
| `do_id` | BIGINT UNSIGNED | PRIMARY KEY, AUTO_INCREMENT | 发货单ID |
| `do_code` | VARCHAR(30) | NOT NULL, UNIQUE | 发货单编号（如 DO20250101001） |
| `so_id` | BIGINT UNSIGNED | NOT NULL, FOREIGN KEY → sales_order.so_id | 关联销售订单ID |
| `customer_id` | BIGINT UNSIGNED | NOT NULL, FOREIGN KEY → customer.customer_id | 客户ID |
| `delivery_time` | DATETIME | DEFAULT CURRENT_TIMESTAMP | 发货时间 |
| `logistics` | VARCHAR(50) |  | 物流公司 |
| `tracking_no` | VARCHAR(50) |  | 物流单号 |
| `status` | TINYINT | DEFAULT 1 | 状态：1-已发货 2-已签收 |

## 三、表关系说明
1. **销售订单与客户**：1:N → 一个客户可下多个销售订单；
2. **销售订单与销售订单明细**：1:N → 一个销售订单包含多个产品明细；
3. **销售订单与生产订单**：1:N 或 N:1 → 支持“一单多产”“多单一产”；
4. **生产订单与物料需求**：1:N → 一个生产订单对应多种物料需求；
5. **生产订单与成品入库**：1:N → 一个生产订单的成品可分批入库；
6. **销售订单与发货单**：1:1 或 1:N → 一个销售订单可分批发货。

## 四、索引优化建议
1. 高频查询字段加索引：`sales_order.customer_id`、`production_order.po_code`、`finished_product_stock.po_id`；
2. 联合索引：`sales_order_item(so_id, product_id)`（优化订单明细查询）；
3. 避免对**状态字段**（如 `status`）单独建索引：低基数字段索引效率低，可与其他字段组合建联合索引。

---

我可以帮你生成这份模板对应的**MySQL建表SQL脚本**，直接复制到数据库中执行就能创建全套表结构。需要吗？