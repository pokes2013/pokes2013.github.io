# CMD流程跳转：GOTO的详解

流程跳转：goto  
一般的批处理命令，都是按照自上而下的流程逐行执行的，也就是说，只有第一行的命令执行了之后，才可能执行第二行，第二行执行完之后，再执行第三行……如此依次执行。  
　　如果对不同的情况，需要执行不同的既定操作，若还是按照常规的执行流程的话，是无法完成任务的，这个时候，就需要引入流程跳转的概念，动用流程跳转语句 goto 了。流程跳转的含义是：改变默认的执行顺序，强制跳转到指定的位置执行特定的程序块。  
　　先来看个例子：假设需要判断用户输入的是A还是B，代码可以写成这样：  
　　

```bash
@echo off
set /p input=请输入字母A或B：
if "%input%"=="A" goto A
if "%input%"=="B" goto B
pause
exit

:A
echo 您输入的字母是A
pause
exit

:B
echo 您输入的字母是B
pause
exit
```

按照一般的执行流程，所有的代码都会自上而下逐行执行一次，结果将显示"您输入的字母是A"和"您输入的字母是B"这两行内容，很显然，这是达不到我们的要求的；但是，实际的结果是：如果您输入的字母非A即B，则结果只会显示"您输入的字母是A"或者"您输入的字母是B"；也就是说，代码的执行顺序发生了改变，不再一成不变地自上而下逐行执行了：当输入字母A后，将执行第一条if语句，此条语句执行后，将跳转到标签段:A，从而绕过了第一条if语句和:A之间的所有代码行；当输入字母B后，将执行头两条if语句，当执行完第二条if语句后，将跳转到标签段:B，从而绕过了第二条if语句和:B之间的所有代码行。

　　从上面的例子可以看到，要让goto语句起作用，还需要:A或:B之类的标签段的配合。所谓的标签段，就是这样的一些代码块：在首行上以单个冒号打头，其后紧跟一串字符，第二行及其之后的所有行为代码语句行。在这里，第一行的冒号是标签标志，紧跟它之后的字符串是标签名，两者合称标签。goto语句后面的部分为标签名，指引着该语句执行完之后该跳到转何方，标签则接收goto语句的跳转指令，引导着goto语句的后续操作。goto语句和标签互相呼应，在实现流程跳转时相辅相成，缺一不可。

下面说一下使用跳转语句goto的注意事项：

　　1、goto语句和标签要互相呼应，不能只有goto语句而没有相应的标签段，否则，程序将找不到相应的标签段而直接退出；只有标签段而没有goto语句是允许的，但不能实现流程跳转功能，从代码精简的角度来看，有标签段而没有goto语句，则此标签是多余的，可以精简掉；  
　　2、若有多个标签段，则需要注意标签段之间是否需要添加合适的退出语句来终止程序继续向下执行，这是很多新手很容易犯错的地方，需要谨慎。以上面这段代码为例，如果去掉:A和:B之间的exit语句，那么，当输入字母A之后，结果将同时显示"您输入的字母是A"和"您输入的字母是B"这两行内容，而保留exit语句将只会在显示"您输入的字母是A"后，按任意键推出批处理程序，因为批处理是自上而下逐行执行的，即使用goto语句跳转之后，在新的位置上，这一执行流程仍然会保持，直到碰上另一个流程跳转语句，执行过程并不会在两个标签段之间自动终止。  
　　3、标签名只可以使用常量，而不能使用变量；  
　　4、若有同名的标签段，将执行位于最顶层的标签段，其后的标签段是否得到执行，将视具体的情况加以处理。

补充1：使用goto实现死循环

```bash
@echo off
:Loop
set "input="
set /p "input=请输入："
echo,%input%
goto :Loop
```

补充2：goto :eof 是什么意思？  
eof 是 End Of File 的缩写  
goto :eof 就是跳转到批处理文件结尾，功能上类似于 exit /b
