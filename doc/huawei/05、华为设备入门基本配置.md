



## 一、华为设备登录

HCIE 场景下华为网络设备登录以**Console 本地初始化**与**STelnet/Web 远程管理**为核心，需结合 AAA 认证、用户分级与安全加固，以下是可直接用于考试与项目的标准化步骤与配置模板。

------

### 1、核心登录方式与适用场景

| 登录方式               | 核心用途                     | 安全等级         | 关键端口                      |
| ---------------------- | ---------------------------- | ---------------- | ----------------------------- |
| Console 口本地登录     | 首次配置、故障恢复、密码重置 | 最高（物理接触） | 无网络端口，用 Console 线直连 |
| STelnet（SSH）远程登录 | 日常 CLI 管理，加密传输      | 高               | TCP 22                        |
| Web 网管登录           | 图形化配置与监控             | 中               | HTTPS 443（HTTP 80 不推荐）   |
| Telnet 远程登录        | 临时调试（仅测试环境）       | 低               | TCP 23（生产禁用）            |

------

### 2、Console 口本地登录（HCIE 必做，首次配置唯一入口）

准备与连接

- 硬件：Console 线（USB-RJ45/DB9）、终端工具（Xshell/PuTTY）。
- 连接：Console 线接设备 Console 口与电脑 USB / 串口，安装驱动后识别 COM 口。
- 终端参数：Serial 模式，波特率 9600、数据位 8、停止位 1、无校验、无流控（华为默认）。

基础认证配置（HCIE 推荐 AAA 认证，比 Password 更规范）

```bash
<Huawei>system-view
[Huawei]user-interface console 0  # 进入Console用户界面
[Huawei-ui-console0]authentication-mode aaa  # 启用AAA认证
[Huawei-ui-console0]user privilege level 15  # 授予最高管理员权限
[Huawei-ui-console0]quit
[Huawei]aaa
[Huawei-aaa]local-user admin password irreversible-cipher Admin@123  # 创建本地用户与密文密码
[Huawei-aaa]local-user admin privilege level 15  # 用户级别15（最高）
[Huawei-aaa]local-user admin service-type terminal  # 允许终端登录
[Huawei-aaa]quit
```

登录验证

打开终端工具，选择对应 COM 口，参数正确即可进入登录页，输入用户名`admin`与密码`Admin@123`，成功进入用户视图`<Huawei>`。

------

### 3、STelnet（SSH）远程登录配置（HCIE 生产环境标准）

前提条件

- 设备管理 IP 已配置（如`10.1.1.1/24`），PC 与设备路由可达。
- 关闭 Telnet，启用 SSH 服务，配置 AAA 认证与用户权限。

完整配置模板（可直接复制）

```bash
<Huawei>system-view
[Huawei]interface GigabitEthernet 0/0/0  # 管理网口
[Huawei-GigabitEthernet0/0/0]ip address 10.1.1.1 255.255.255.0
[Huawei-GigabitEthernet0/0/0]quit
[Huawei]stelnet server enable  # 启用STelnet（SSH）服务
[Huawei]ssh user admin authentication-type password  # SSH用户认证方式
[Huawei]ssh user admin service-type stelnet  # 允许STelnet登录
[Huawei]user-interface vty 0 4  # 配置0-4号虚拟终端
[Huawei-ui-vty0-4]authentication-mode aaa  # VTY启用AAA认证
[Huawei-ui-vty0-4]protocol inbound ssh  # 仅允许SSH，禁用Telnet
[Huawei-ui-vty0-4]user privilege level 15
[Huawei-ui-vty0-4]quit
[Huawei]aaa
[Huawei-aaa]local-user admin password irreversible-cipher Admin@123
[Huawei-aaa]local-user admin privilege level 15
[Huawei-aaa]local-user admin service-type ssh
[Huawei-aaa]quit
```

客户端登录命令

```bash
ssh admin@10.1.1.1  # 终端输入，验证通过进入用户视图
```

------

### 4、Web 网管登录（辅助图形化操作）

启用 HTTPS 并配置用户

```bash
[Huawei]http secure-server enable  # 启用HTTPS服务
[Huawei]aaa
[Huawei-aaa]local-user webadmin password irreversible-cipher Web@123
[Huawei-aaa]local-user webadmin privilege level 15
[Huawei-aaa]local-user webadmin service-type http
[Huawei-aaa]quit
```

登录操作

PC 设同网段 IP（如`10.1.1.2/24`），浏览器访问`https://10.1.1.1`，输入用户名`webadmin`与密码`Web@123`登录。

------

### 5、HCIE 级安全加固要点（考试与生产必配）

禁用 Telnet，仅启用 SSH 与 HTTPS，关闭 HTTP 服务。

配置 ACL 限制管理 IP：仅允许指定网段登录，拒绝其他 IP。

```bash
[Huawei]acl number 2000
[Huawei-acl-basic-2000]rule permit source 192.168.1.0 0.0.0.255
[Huawei-acl-basic-2000]rule deny source any
[Huawei-acl-basic-2000]quit
[Huawei]user-interface vty 0 4
[Huawei-ui-vty0-4]acl 2000 inbound
```

1. 设置登录超时：`[Huawei-ui-vty0-4]idle-timeout 5 0`（5 分钟无操作自动登出）。
2. 密码复杂度：至少 8 位，含大小写、数字、特殊字符（如`Admin@123`）。

------

### 6、常见排错（HCIE 故障处理高频考点）

1. Console 登录失败：检查 COM 口识别、终端参数、物理连接，重新插拔线缆并重启终端。
2. STelnet 无法连接：Ping 通设备 IP→检查 SSH 服务是否启用→确认 ACL 是否放行→验证 AAA 用户配置。
3. Web 登录异常：确认 HTTPS 端口 443 未被防火墙拦截→清除浏览器缓存→核对本地用户`service-type http`配置。

------

### 7、HCIE 考试易错点

- 混淆 VTY 与 Console 用户界面配置，导致认证不生效。
- 未配置`protocol inbound ssh`，VTY 仍允许 Telnet 登录。
- 本地用户未绑定对应服务类型（如 SSH/HTTP），登录被拒绝。



### 8、华为设备一键登录脚本

```bash
# 1. 进入系统视图
<Huawei>system-view
[Huawei]sysname HCIE-Device  # 修改设备名称，可自定义
[HCIE-Device]

# 2. 配置管理网口IP（基础前提：确保PC与设备可达）
interface GigabitEthernet 0/0/0
 ip address 10.1.1.1 255.255.255.0
 undo shutdown  # 启用网口（部分设备默认启用，此命令兼容冗余）
 quit

# 3. Console口本地登录配置（首次登录/故障恢复必备，AAA认证+最高权限）
user-interface console 0
 authentication-mode aaa  # 启用AAA认证（比密码认证更规范，HCIE推荐）
 user privilege level 15  # 授予15级最高管理员权限
 idle-timeout 10 0  # 控制台超时时间10分钟，0表示无秒数补充
 quit

# 4. STelnet(SSH)远程登录配置（生产环境标准，禁用Telnet）
stelnet server enable  # 启用STelnet服务（SSH核心命令）
ssh user admin authentication-type password  # SSH用户认证方式为密码
ssh user admin service-type stelnet  # 授权admin用户使用STelnet服务
# 配置VTY虚拟终端（远程登录入口）
user-interface vty 0 4
 authentication-mode aaa  # VTY启用AAA认证
 protocol inbound ssh  # 仅允许SSH登录，禁用Telnet（安全加固关键）
 user privilege level 15  # 远程用户最高权限
 idle-timeout 5 0  # 远程登录超时5分钟，自动登出
 quit

# 5. Web(HTTPS)图形化登录配置（禁用HTTP，仅启用加密HTTPS）
undo http server enable  # 关闭不安全的HTTP服务
http secure-server enable  # 启用HTTPS加密服务（端口443）
 quit

# 6. AAA本地用户配置（绑定所有登录方式，权限+服务类型绑定）
aaa
 # 配置Console/SSH通用管理员用户
 local-user admin password irreversible-cipher Admin@123  # 密文存储密码，不可逆向解析
 local-user admin privilege level 15  # 最高权限
 local-user admin service-type terminal ssh  # 绑定Console（terminal）和SSH服务
 # 配置Web专用管理员用户
 local-user webadmin password irreversible-cipher Web@123
 local-user webadmin privilege level 15
 local-user webadmin service-type http  # 绑定Web（HTTP/HTTPS）服务
 quit

# 7. 安全加固：ACL限制仅指定网段可登录（HCIE考试/生产必配）
acl number 2000  # 基本ACL，用于限制源IP
 rule permit source 192.168.1.0 0.0.0.255  # 允许指定运维网段登录
 rule deny source any  # 拒绝所有其他网段登录
 quit
# 将ACL应用到VTY虚拟终端（远程登录入口）
user-interface vty 0 4
 acl 2000 inbound  # 入方向应用ACL，拦截非法IP
 quit

# 8. 保存配置（避免设备重启后配置丢失，HCIE考试必做）
save
# 提示是否保存时，输入Y确认保存，等待配置保存完成即可
```



## 二、CLI命令行操作（进入视图、保存配置、查看信息）

CLI（命令行界面）是设备 / 系统管理的核心方式，不同环境（网络设备、操作系统）的操作存在差异，下面分 ** 主流网络设备（华为 / 华三 / 思科）和操作系统（Linux/Windows）两类，详细讲解核心操作。

网络设备CLI（华为 / 华三 / 思科，以华为 VRP 系统为核心，附差异说明）

网络设备 CLI 采用分层视图设计，不同操作需要进入对应视图，核心视图包括：用户视图、系统视图、接口视图等。

### 1. 进入各类核心视图

#### （1） 登录默认：用户视图（查看状态、简单测试）

- 登录设备后自动进入用户视图，提示符标识：`<设备名称>`（例：`<Huawei>`）
- 功能：仅支持查看设备状态、执行 ping/tracert 等简单测试，无法配置设备

#### （2） 核心过渡：进入系统视图（全局配置入口）

- 命令：`system-view`（华为 / 华三通用；思科对应：`enable`（进入特权模式）→ `configure terminal`（进入全局配置模式））

- 操作示例：

  ```bash
  <Huawei> system-view  # 从用户视图进入系统视图
  Enter system view, return user view with Ctrl+Z.
  [Huawei]  # 系统视图提示符：[设备名称]
  ```

  

- 功能：全局配置的统一入口，可在此创建 VLAN、配置系统参数，也可从这里进入其他业务视图

#### （3） 业务配置：进入具体功能视图（以接口视图为例，其他视图类似）

- 命令：`interface 接口类型 接口编号`（华为 / 华三 / 思科通用，仅接口命名有差异）

- 操作示例（华为以太网接口）：

  ```bash
  [Huawei] interface GigabitEthernet 0/0/1  # 进入千兆以太网0/0/1接口视图
  [Huawei-GigabitEthernet0/0/1]  # 接口视图提示符：[设备名称-接口名称]
  ```

  

- 其他常见视图进入命令：

  - VLAN 视图：`vlan 10`（在系统视图中执行，进入 VLAN 10 配置视图）
  - 路由协议视图：`ospf 1 router-id 192.168.1.1`（在系统视图中执行，进入 OSPF 1 进程视图）

#### （4） 退出视图（返回上一级 / 直接退出到用户视图）

- 返回上一级视图：`quit`（逐层返回，例：接口视图→系统视图→用户视图）
- 直接返回用户视图：`Ctrl+Z` 快捷键（所有网络设备通用，高效快捷）
- 退出 CLI 登录：`logout`（在用户视图中执行）

### 2. 保存配置（关键：避免设备重启后配置丢失）

网络设备配置分为「临时配置」（内存中，重启失效）和「永久配置」（存储在闪存中，重启保留），保存操作即把临时配置写入永久存储。

（1） 华为/华三设备保存命令

- 核心命令 1（推荐）：`save`（在任意视图均可执行，优先在用户视图 / 系统视图使用）

- 核心命令 2（指定保存路径）：`save [存储路径]`（默认路径可直接回车忽略）

- 操作示例：

  ```bash
  [Huawei] save  # 执行保存
  The current configuration will be written to the device.
  Are you sure to continue? [Y/N]: Y  # 输入Y确认保存
  Please input the file name (*.cfg, *.zip) [vrpcfg.cfg]:  # 回车使用默认文件名
  Saving the current configuration to the device successfully.
  ```

（2） 思科设备保存命令

- 特权模式下执行：`write memory`（简写：`wr`）
- 或：`copy running-config startup-config`（将运行配置（临时）复制到启动配置（永久））

### 3. 查看核心信息（常用查询命令）

（1）查看设备版本 / 系统信息

```bash
<Huawei> display version  # 华为/华三：查看设备型号、VRP版本、硬件信息
Router# show version      # 思科：查看系统版本、硬件配置
```

（2）查看当前配置（生效配置）

```bash
<Huawei> display current-configuration  # 华为/华三：简写 dis cu
Router# show running-config             # 思科：简写 sh run（查看运行配置）
Router# show startup-config             # 思科：查看启动配置（下次重启生效）
```

（3）查看接口状态 / 配置

```bash
<Huawei> display interface GigabitEthernet 0/0/1  # 华为/华三：查看指定接口状态、IP等
<Huawei> display ip interface brief              # 华为/华三：简写 dis ip int b，批量查看所有接口IP和状态
Router# show interfaces GigabitEthernet 0/1       # 思科：查看指定接口详情
Router# show ip interface brief                   # 思科：批量查看接口IP和状态
```

（4）查看网络路由信息

```bash
<Huawei> display ip routing-table  # 华为/华三：简写 dis ip rout，查看路由表
Router# show ip route              # 思科：查看路由表
```

### 总结

1. **网络设备 CLI**：核心是「分层视图切换」（用户→系统→业务视图），保存配置用`save`（华为 / 华三）/`write memory`（思科），查看信息用`display`（华为 / 华三）/`show`（思科）系列命令。
2. **操作系统 CLI**：无分层视图，仅需权限切换（`su -`/`sudo`（Linux）、管理员运行（Windows）），配置保存分「自动生效」和「修改配置文件保存」，查看信息用专用系统命令。
3. 通用技巧：多数 CLI 支持命令简写，可通过`?`查询命令帮助（如华为：`dis ?`，思科：`show ?`）。

## 三、华为设备配置文件备份与导入

华为网络设备的配置文件分为 **临时配置（running-config）** 和 **永久配置（saved-config）**，备份与导入的核心是对永久配置文件的管理，常用方式包括**本地存储备份**、**TFTP/FTP/SFTP 服务器备份**、**USB 存储备份**，以下是 HCIE 考试与工程实践中高频使用的配置步骤。

### 1、核心概念

1. **配置文件类型**
   - `vrpcfg.zip`：华为设备默认的压缩格式配置文件（保存时自动压缩）。
   - 临时配置：设备当前运行的配置，未保存时重启会丢失。
   - 永久配置：保存在设备存储介质（如 `flash:`）中的配置，重启后生效。
2. **存储介质**
   - 设备本地：`flash:`（闪存）、`sdcard:`（SD 卡）
   - 外部存储：USB 盘（`usb0:`）
   - 远程服务器：TFTP/FTP/SFTP 服务器

### 2、配置文件备份（导出）

方式 1：本地备份（保存配置到设备本地）

这是最基础的操作，用于将**临时配置固化为永久配置**，避免重启丢失。

```shell
# 1. 保存当前运行配置到默认存储路径（flash:/vrpcfg.zip）
<Device> save

# 2. 保存到指定路径并自定义文件名（如 flash:/backup_20251229.zip）
<Device> save flash:/backup_20251229.zip all
# all 参数：保存所有单板的配置（多框设备必加）
```

方式 2：远程服务器备份（TFTP/FTP/SFTP）

**推荐使用 SFTP**（加密传输，安全性高），需提前搭建 SFTP 服务器（如 Linux 的 `vsftpd`+`ssh` 或 Windows 的 FreeSSHd）。

前提条件

- 设备与服务器路由可达。
- 服务器已创建授权用户（如 `huawei`，密码 `Huawei@123`）。
- 服务器已配置共享目录（如 `/srv/sftp`）。

配置步骤（以 SFTP 为例）

```shell
# 1. 进入系统视图
<Device> system-view
[Device]

# 2. 配置设备与服务器的 IP 连通性（如配置管理口 IP）
[Device] interface MEth 0/0/0
[Device-MEth0/0/0] ip address 192.168.1.100 255.255.255.0
[Device-MEth0/0/0] quit

# 3. 备份本地配置文件到 SFTP 服务器
[Device] sftp 192.168.1.200  # SFTP 服务器 IP
# 输入服务器用户名和密码
Username: huawei
Password: Huawei@123

# 4. 上传设备配置文件到服务器
[sftp] put flash:/vrpcfg.zip /srv/sftp/device_backup.zip
# 格式：put 本地文件路径 服务器目标路径

# 5. 退出 SFTP 会话
[sftp] quit
```

TFTP 方式（无密码，仅实验室环境使用）

```shell
# 直接上传配置文件到 TFTP 服务器
[Device] tftp 192.168.1.200 put flash:/vrpcfg.zip device_backup.zip
```

方式 3：USB 存储备份

适用于无远程服务器的场景，需提前将 USB 盘插入设备 USB 接口。

```shell
# 1. 查看 USB 盘是否识别
<Device> dir usb0:/

# 2. 备份配置文件到 USB 盘
<Device> copy flash:/vrpcfg.zip usb0:/device_backup.zip
Copy flash:/vrpcfg.zip to usb0:/device_backup.zip?[Y/N]:y
```

### 3、配置文件导入（恢复）

方式 1：本地导入（从设备本地恢复配置）

用于设备配置丢失或需要回滚到历史配置的场景。

```shell
# 1. 从指定本地文件恢复配置（覆盖当前运行配置）
<Device> startup saved-configuration flash:/backup_20251229.zip
# 2. 重启设备使配置生效
<Device> reboot
# 注意：重启前确认当前配置无需保留，否则先执行 save 备份
```

方式 2：远程服务器导入（SFTP 为例）

从远程服务器下载配置文件到设备，再加载生效。

```shell
# 1. 登录 SFTP 服务器
[Device] sftp 192.168.1.200
Username: huawei
Password: Huawei@123

# 2. 下载服务器配置文件到设备 flash
[sftp] get /srv/sftp/device_backup.zip flash:/new_vrpcfg.zip

# 3. 退出 SFTP 并设置启动配置
[sftp] quit
[Device] startup saved-configuration flash:/new_vrpcfg.zip
[Device] reboot
```

方式 3：USB 存储导入

```shell
# 1. 将 USB 盘插入设备，查看文件
<Device> dir usb0:/

# 2. 复制 USB 中的配置文件到设备 flash
<Device> copy usb0:/device_backup.zip flash:/new_vrpcfg.zip

# 3. 设置启动配置并重启
<Device> startup saved-configuration flash:/new_vrpcfg.zip
<Device> reboot
```

### 4、HCIE 高频考点与注意事项

1. **配置文件验证**
   - 备份后验证文件完整性：`dir flash:/vrpcfg.zip` 查看文件大小。
   - 恢复后验证配置：`display current-configuration` 对比备份内容。
2. **权限要求**
   - 执行 `save`/`startup`/`copy` 命令需要 **管理员权限**（级别 3）。
   - SFTP/FTP 服务器需配置正确的用户权限，避免读写失败。
3. **加密传输优先**
   - 生产环境禁止使用 TFTP（明文传输），优先选择 **SFTP** 或 **SCP**。
4. **多框设备注意事项**
   - 集群 / 堆叠设备需使用 `save all` 命令，确保所有成员设备配置同步备份。
5. **配置文件冲突处理**
   - 恢复配置前若当前配置有修改，需选择是否保留：重启时按提示选择 `Y/N`。

### 5、故障排查（HCIE 面试高频）

1. **远程备份失败**
   - 排查路由连通性：`ping 服务器 IP`。
   - 排查服务器服务状态：`netstat -an | grep 22`（SFTP 端口）。
   - 排查用户权限：服务器端检查用户是否有读写共享目录的权限。
2. **USB 导入失败**
   - 检查 USB 格式：华为设备支持 **FAT32** 格式，不支持 NTFS。
   - 检查 USB 接口：更换 USB 口或重新插拔。