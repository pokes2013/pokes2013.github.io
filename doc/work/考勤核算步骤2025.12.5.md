# 考勤核算步骤2025.10.7





## 数据逆透视

1、打开原始数据，复制一份新的源数据，将姓名和考勤记录放到一行。并且将日期格式化；

2、隔行删除，1.1.1

3、逆透视前，使用“休息”占位，保留没有打卡记录的日期，具体选中打卡所有数据列将“null”替换为“休息”；

4、选中“姓名”，右键选择“逆透视其他列”

5、切片，间隔5，重复

完成数据整理

## 考勤公式

字段名称和公式配套，请问更改

```bash
早上上班
早上下班
下午上班
下午下班
末次打卡2
末次打卡3
末次打卡4
末次打卡5
打卡次数：=COUNTA(表1_2[@[早上上班]:[末次打卡5]])
首次打卡：=MIN(表1_2[@[早上上班]:[末次打卡5]])
末次打卡：=MAX(表1_2[@[早上上班]:[末次打卡5]])
标准上班时间：=XLOOKUP([@姓名],人员信息!B:B,人员信息!D:D)

实际上班时间：=IF(XLOOKUP([@姓名],人员信息!B:B,人员信息!D:D)<[@首次打卡],[@首次打卡],XLOOKUP([@姓名],人员信息!B:B,人员信息!D:D))

打卡次数异常：=IF(L2<4, "缺卡","")
工时不足：=IF([@净工时]<8,"工时异常","")
迟到统计：==IF([@首次打卡] > ([@标准上班时间] + TIME(0,5,0)), "迟到", "")    ##加了5分钟
=([@首次打卡]-[@标准上班时间])*1440
人工判断：
毛工时：
夏季作息时间
=MROUND(([@末次打卡]-[@实际上班时间])*24,0.5)
冬季季作息时间
=FLOOR(([@末次打卡]-[@实际上班时间])*24, 0.5) + IF(MINUTE([@末次打卡])>30, 0.5, 0)

中午休息时间：1.5
净工时：=[@毛工时]-[@中午休息时间]
工时统计：==IF([@计算类型]="计天", 1, IF([@净工时]<5, "请假或缺卡", [@净工时]))
把休息的直接处理为休息

打卡异常处理：
```



## 数据类型有误的解决方法

这是处理大量数据的最佳方法：

1. **全选要转换的列**（按住 Ctrl 键可多选）
2. **数据** → **分列**
3. 直接点击 **完成**（无需任何设置）
4. 数据立即转换为真正的时间格式
