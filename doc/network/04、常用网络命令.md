用于**网络故障排查**的命令，覆盖连通性测试、端口检测、路由查看、网络状态监控等场景。
以下按 **Windows/Linux/macOS** 分系统整理高频命令，附用法和典型场景。

## 一、 通用基础命令（跨系统）

### 1.ping连通性测试

**作用**：测试本地主机与目标主机的网络连通性，返回延迟和丢包率。**核心参数**：

| 系统        | 常用命令                         | 说明                                   |
| ----------- | -------------------------------- | -------------------------------------- |
| Windows     | `ping -n 10 -w 2000 目标IP/域名` | `-n` 指定发包数，`-w` 超时时间（毫秒） |
| Linux/macOS | `ping -c 10 -W 2 目标IP/域名`    | `-c` 指定发包数，`-W` 超时时间（秒）   |

**典型场景**：

- 测试内网连通：`ping 192.168.1.1`
- 测试公网连通：`ping -n 5 www.baidu.com`
- 检测丢包：连续 ping 目标，若出现 `Request timed out` 则表示丢包。

### 2.ipconfig查看网卡信息

**作用**：查看本地 IP 地址、子网掩码、网关、DNS 等网络配置，排查 IP 分配问题。**常用命令**：

- Windows：

  ```bash
  ipconfig          # 基础信息
  ipconfig /all     # 详细信息（含MAC地址、DNS、DHCP服务器）
  ipconfig /release # 释放DHCP分配的IP
  ipconfig /renew   # 重新获取IP
  ```

  

- Linux/macOS：

  ```bash
  ifconfig                  # 传统命令（部分系统需安装net-tools）
  ip addr show              # 查看所有网卡IP
  ip link show              # 查看网卡状态（是否up）
  ```

**典型场景**：排查 IP 地址冲突、确认网关是否正确、检查 DNS 配置是否有误。
### 3.tracert追踪数据包

tracert 是 Windows 系统的网络诊断命令，用于追踪数据包从本地到目标主机的传输路径、每跳延迟与故障节点，核心是通过递增 TTL 值逐跳探测，Linux/macOS 对应工具为 traceroute。以下是完整用法与实操指南。

命令格式：

```bash
tracert [/参数] <目标主机名或IP>
```

常用参数速查表（Windows）

| 参数          | 作用                         | 示例                                                       |
| ------------- | ---------------------------- | ---------------------------------------------------------- |
| /d            | 不解析 IP 到主机名，加速执行 | tracert /d 223.5.5.5                                       |
| /h <maxhops>  | 最大跃点数，默认 30          | tracert /h 15 [www.baidu.com](https://www.baidu.com/)      |
| /w <timeout>  | 每跳超时（毫秒），超时显示 * | tracert /w 2000 8.8.8.8                                    |
| /4            | 强制用 IPv4                  | tracert /4 [www.microsoft.com](https://www.microsoft.com/) |
| /6            | 强制用 IPv6                  | tracert /6 2001:4860:4860::8888                            |
| /j <hostlist> | 松散源路由（IPv4 专用）      | tracert /j 192.168.1.1 223.5.5.5                           |
| /?            | 显示帮助                     | tracert /?                                                 |

------

1. 打开命令行：Win+R 输入 cmd 或 powershell 回车。
2. 输入命令：按需求选择参数与目标，如 `tracert www.baidu.com` 或 `tracert /d /h 20 8.8.8.8`。
3. 查看输出：等待执行完成，分析每跳的 IP、主机名与三次延迟（单位：ms）；* 表示超时未响应。

输出示例与解读：

```bash
Tracing route to www.baidu.com [110.242.68.66] over a maximum of 30 hops:
  1    <1 ms    <1 ms    <1 ms  192.168.1.1       # 本地网关
  2     5 ms     4 ms     4 ms  100.64.0.1        # 运营商网关
  3    12 ms    11 ms    10 ms  223.112.0.1       # 骨干路由器
...
 10    28 ms    27 ms    26 ms  110.242.68.66     # 目标主机
Trace complete.
```

- 第 1 列：跃点序号；
- 第 2-4 列：三次探测延迟；
- 第 5 列：节点 IP / 主机名。

典型场景与用法：

1. 快速路径探测（禁用 DNS 解析）

   ```bash
   tracert /d www.taobao.com
   ```

2. 限制最大跳数（避免过长追踪）

   ```bash
   tracert /h 15 223.5.5.5
   ```


3. 延长超时（网络不稳定时）

   ```bash
   tracert /w 3000 blog.csdn.net
   ```


4. 强制 IPv4/IPv6 追踪

   ```bash
   tracert /4 www.google.com
   tracert /6 2400:da00::6666
   ```


5. 故障定位

   - 连续 * 多为节点丢包或防火墙拦截；
   - 某跳延迟突增可定位瓶颈节点；
   - 重复出现同一 IP 可能存在路由环路。

------

注意事项：

- 依赖 ICMP 回显与超时消息，部分网络 / 防火墙可能禁用 ICMP 导致结果不全；
- Linux/macOS 用 traceroute，参数略有差异（如 -n 对应 /d，-m 对应 /h）；
- 公网目标可能受路由策略影响，路径非固定。

------

Linux/macOS 对应命令参考

```bash
# 基础追踪
traceroute www.baidu.com
# 禁用 DNS 解析
traceroute -n 8.8.8.8
# 最大跳数 15
traceroute -m 15 223.5.5.5
```

## 二、 端口与连接检测命令

### 1. `telnet` —— 端口连通性测试

**作用**：测试目标主机的**特定端口是否开放**，适用于排查服务是否正常监听。**语法**：

```bash
telnet 目标IP 端口号
```

**典型场景**：

- 测试 HTTP 服务：`telnet www.baidu.com 80`
- 测试 SSH 服务：`telnet 192.168.1.100 22`
- 若提示 `Connected to xxx` 则端口开放；若超时则端口关闭或被防火墙拦截。

> 注意：Windows 默认未安装 telnet，需在「控制面板→程序→启用或关闭 Windows 功能」中勾选 **Telnet 客户端**。

### 2. `netstat` —— 查看网络连接状态

**作用**：列出本地所有网络连接（TCP/UDP）、监听端口、进程 PID，排查端口占用、异常连接。**核心参数**：

| 系统        | 常用命令         | 说明                                                         |
| ----------- | ---------------- | ------------------------------------------------------------ |
| Windows     | `netstat -ano`   | `-a` 所有连接，`-n` 不解析域名，`-o` 显示进程 PID            |
| Linux/macOS | `netstat -tulnp` | `-t` TCP，`-u` UDP，`-l` 监听端口，`-n` 不解析，`-p` 显示进程 |

**典型场景**：

- 查找 8080 端口被哪个进程占用：
  
  Windows：

  ```bash
  netstat -ano | findstr "8080"
  ```

  Linux：

  ```bash
  netstat -tulnp | grep 8080
  ```

### 3. `ss`（Linux 专用）—— 替代 netstat 的高性能命令

**作用**：功能与 `netstat` 类似，但速度更快、信息更全，是 Linux 推荐工具。**常用命令**：

```bash
ss -tuln           # 查看所有监听的TCP/UDP端口
ss -antp           # 查看所有TCP连接及进程
ss -uap            # 查看所有UDP连接及进程
```

## 三、 路由与 DNS 排查命令

### 1. `route` —— 查看 / 修改路由表

**作用**：查看本地路由规则，排查数据包转发路径问题（如默认网关错误）。**常用命令**：

- Windows：

  ```bash
  route print       # 查看完整路由表
  route add 目标网段 mask 子网掩码 网关IP  # 添加静态路由
  ```

- Linux/macOS：

  ```bash
  route -n          # 查看路由表（-n 不解析域名）
  ip route show     # 等价于 route -n
  ```


**典型场景**：内网访问跨网段设备失败时，检查路由表是否存在对应网段的转发规则。

### 2. `nslookup`/`dig` —— DNS 解析测试

**作用**：测试域名解析是否正常，排查 DNS 服务器故障。

- **nslookup**（跨系统）：

  ```bash
  nslookup www.baidu.com      # 用默认DNS解析域名
  nslookup www.baidu.com 8.8.8.8  # 用指定DNS（如谷歌8.8.8.8）解析
  ```


- **dig**（Linux/macOS 优先，功能更强）：

  ```bash
  dig www.baidu.com           # 详细解析信息
  dig @8.8.8.8 www.baidu.com  # 指定DNS服务器
  dig -x 223.5.5.5            # 反向解析IP对应的域名
  ```


**典型场景**：域名无法访问但 IP 可访问时，用此命令排查 DNS 解析故障。

## 四、 高级网络诊断命令

### 1. `pathping`（Windows 专用）—— 结合 ping + tracert

**作用**：同时测试连通性和路径延迟，还会统计每跳节点的丢包率，比 tracert 更详细。**语法**：

```bash
pathping /d /h 20 www.baidu.com
```

- `/d` 禁用 DNS 解析，`/h` 限制最大跳数。
- 输出会分两部分：**路由路径** + **每跳丢包统计**，适合定位网络丢包的具体节点。

### 2. `mtr`（Linux/macOS 专用）—— 动态路径追踪

**作用**：相当于 `traceroute` + `ping` 的结合体，**实时持续追踪**路径节点的延迟和丢包率，适合长时间监控网络稳定性。**常用命令**：

```bash
mtr -n www.baidu.com  # -n 禁用DNS解析，快速输出
mtr -r www.baidu.com  # -r 生成报告模式，非实时输出
```

**典型场景**：排查网络波动、间歇性丢包问题，比 tracert 更精准。

### 3. `curl`/`wget` —— 测试 HTTP/HTTPS 服务

**作用**：模拟客户端发送 HTTP 请求，测试网页是否能正常访问、返回状态码是否正确。**常用命令**：

```bash
curl -I www.baidu.com  # -I 只返回响应头，查看状态码（200=正常，404=不存在，500=服务器错误）
wget www.baidu.com     # 下载网页，测试是否能正常获取内容
```

## 五、 防火墙相关排查命令

### 1. Windows：`netsh advfirewall`

**作用**：查看 / 配置 Windows 防火墙规则，排查是否拦截了端口或程序。**常用命令**：

```bash
netsh advfirewall show allprofiles  # 查看防火墙所有配置文件状态
netsh advfirewall set allprofiles state off  # 临时关闭防火墙（测试用）
```

### 2. Linux：`iptables`/`ufw`

**作用**：查看 Linux 防火墙规则，排查端口是否被拦截。**常用命令**：

```bash
iptables -L -n  # 查看所有防火墙规则（-n 不解析域名）
ufw status     # Ubuntu/Debian 系统查看 ufw 防火墙状态
```

## 六、 故障排查流程建议

1. **先 ping 目标**：确认是否能连通，判断是本地 / 网络 / 目标问题；
2. **查本地 IP 配置**：用 `ipconfig`/`ip addr` 确认 IP、网关、DNS 是否正确；
3. **追踪路径**：用 `tracert`/`mtr` 定位故障节点；
4. **测试端口**：用 `telnet`/`curl` 确认目标服务端口是否开放；
5. **查 DNS 解析**：用 `nslookup`/`dig` 确认域名解析是否正常。